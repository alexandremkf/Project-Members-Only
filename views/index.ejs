<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Members Only</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>

  <div class="container">

    <!-- NAV / HEADER -->
    <div class="nav">
      <div>
        <h1>Members Only üïµÔ∏è</h1>
        <p>Confidential clubhouse</p>
      </div>

      <div>
        <% if (user) { %>
          <span style="margin-right: 12px;">
            Ol√°, <strong><%= user.firstName %></strong>
          </span>

          <a href="/messages/new" class="btn">New Message</a>

          <% if (!user.membershipStatus) { %>
            <a href="/join" class="btn-secondary">Join</a>
          <% } %>

          <a href="/logout" class="btn-secondary">Logout</a>
        <% } else { %>
          <a href="/login" class="btn">Login</a>
          <a href="/signup" class="btn-secondary">Signup</a>
        <% } %>
      </div>
    </div>

    <!-- STATUS DO USU√ÅRIO -->
    <% if (user && user.membershipStatus) { %>
      <div class="alert alert-success">
        ‚≠ê Access level: MEMBER
      </div>
    <% } %>

    <!-- MESSAGES -->
    <% messages.forEach(message => { %>
      <div class="message-card">

        <!-- DELETE (ADMIN ONLY) -->
        <% if (user && user.isAdmin) { %>
          <form
            class="delete-form"
            action="/messages/<%= message.id %>/delete"
            method="POST"
          >
            <button type="submit" class="btn-danger">Delete</button>
          </form>
        <% } %>

        <h3><%= message.title %></h3>
        <p><%= message.text %></p>

        <!-- MEMBER VIEW -->
        <% if (user && user.membershipStatus) { %>
          <div class="message-meta">
            By <%= message.User.firstName %> ‚Ä¢
            <%= message.createdAt.toDateString() %>
          </div>
        <% } %>

        <!-- ADMIN VIEW -->
        <% if (user && user.isAdmin) { %>
          <div class="message-meta admin-badge">
            üëë ADMIN VIEW ‚Äî
            <%= message.User.firstName %> |
            <%= message.User.username %>
          </div>
        <% } %>

      </div>
    <% }) %>

    <!-- FOOTER -->
    <div class="footer">
      Internal system ‚Ä¢ Members Only
    </div>

  </div>

</body>
</html>